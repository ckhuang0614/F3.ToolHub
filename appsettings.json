{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "Serilog": {
    "Using": [ "Serilog.Sinks.Console", "Serilog.Sinks.File" ],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "Microsoft.Hosting.Lifetime": "Information"
      }
    },
    "WriteTo": [
      { "Name": "Console" },
      {
        "Name": "File",
        "Args": {
          "path": "logs/toolhub-.log",
          "rollingInterval": "Day",
          "shared": true,
          "outputTemplate": "{Timestamp:O} [{Level:u3}] {SourceContext} {Message:lj}{NewLine}{Exception}"
        }
      }
    ],
    "Enrich": [ "FromLogContext", "WithMachineName" ],
    "Properties": {
      "Application": "F3.ToolHub"
    }
  },
  "AllowedHosts": "*",
  "ApiSecurity": {
    "HeaderName": "X-Api-Key"
  },
  "Modbus": {
    "Host": "127.0.0.1",
    "Port": 502,
    "SlaveId": 1,
    "ConnectTimeoutSeconds": 3,
    "ResponseTimeoutSeconds": 3,
    "Actions": [
      {
        "Name": "read-registers",
        "Description": "Reads the default holding registers.",
        "StartAddress": 0,
        "NumberOfPoints": 4,
        "Registers": [
          {
            "Name": "line.temperature",
            "Offset": 0,
            "DataType": "UInt16",
            "Scale": 0.1,
            "Unit": "C"
          },
          {
            "Name": "line.humidity",
            "Offset": 1,
            "DataType": "UInt16",
            "Scale": 0.1,
            "Unit": "%"
          },
          {
            "Name": "line.energy",
            "Offset": 2,
            "DataType": "UInt32",
            "Scale": 1.0,
            "Unit": "Wh"
          }
        ]
      }
    ],
    "Polling": {
      "Enabled": true,
      "ActionName": "read-registers",
      "IntervalSeconds": 5
    },
    "Resilience": {
      "MaxRetryAttempts": 5,
      "BaseDelayMilliseconds": 500,
      "MaxDelayMilliseconds": 5000,
      "CircuitBreakerFailureThreshold": 5,
      "CircuitBreakerDurationSeconds": 30,
      "ConnectionPoolSize": 4
    },
    "Output": {
      "File": {
        "Enabled": true,
        "Path": "data/plc-history.jsonl"
      },
      "Mqtt": {
        "Enabled": true,
        "Host": "localhost",
        "Port": 1883,
        "Topic": "plc/simulator"
      }
    },
    "Monitoring": {
      "AlertWebhooks": [
        {
          "Enabled": false,
          "Name": "teams",
          "Url": "https://hooks.example.local/api/alert",
          "SecretHeaderName": "X-Alert-Secret",
          "Secret": ""
        }
      ]
    }
  }
}
